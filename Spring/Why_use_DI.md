# DI를 쓰면 좋은점

보통 Dao와 DB 커넥션 생성 클래스 사이에는 DataSource라는 인터페이스를 뒀다. 그래서 Dao는 자신이 사용하는 오브젝트의 클래스가 무엇인지 알 필요가 없다. 또한 DI를 통해 외부에서 사용할 오브젝트를 주입받기 때문에 오브젝트 생성에 대한 부담을 지지 않아도 된다. 코드의 수정 없이도 얼마든지 의존 오브젝트를 바꿔가면서 사용할 수 있다.

하지만 절대로 DataSOurce의 구현 클래스를 바꾸지 않을 것이고 개발하는 시스템은 운영중에 항상 같은 DataSource의 구현체(SimpleDriverDataSource와 같은)를 통해서만 DB 커넥션을 가져올 것이다. 그런데도 굳이 DataSource 인터페이스를 사용해야 하고 DI를 주입해주는 방식을 이용해야 하는지 의문이 들 수도 있다. 그래도 인터페이스를 두고 DI를 적용해야 한다.

### 인터페이스를 두고 DI를 적용해야하는 이유
첫째, 소프트웨어 개발에서 절대로 바뀌지 않는 것은 없기 때문이다. 클래스 대신 인터페이스를 사용하고, new를 이용해 생성하는 대신 DI를 통해 주입받게 하는 건 아주 단순하고 쉬운 작업이다. 당장에는 클래스를 바꿔서 사용할 계획이 전혀 없더라도, 언젠가 변경이 필요한 상황이 닥쳤을 때 수정에 들어가는 시간과 비용의 부담을 줄여줄 수 있다면, 인터페이스를 사용하고 DI를 적용하는 작은 수고를 하지 않을 이유가 없다.

둘째, 클래스의 구현 방식은 바뀌지 않더라고 하더라도 인터페이스를 두고 DI를 적용하게 해두면 다른 차원의 서비스 기능을 도입할 수 있기 때문이다. Dao와 DataSource사이에 새로운 부가기능을 추가(Count같은 기능)하고 필요없어 졌을 때 간단하게 제거할 수 있게 된다. 이런 기법을 스프링에서는 AOP라는 기술로 만들어 주기도 한다. AOP도 DI를 적용하지 않았다면 처음부터 불가능했을 기술이다.

셋째, 테스트 때문이다. 단지 효율적인 테스트를 손쉽게 만들기 위해서라도 DI를 적용해야 한다. 테스트를 잘 활용하려면 자동으로 실행 가능하며 빠르게 동작하도록 테스트 코드를 만들어야 한다. 그러기 위해서는 가능한 한 작은 단위의 대상에 국한해서 테스트해야 한다. 테스트할 대상의 범위가 넓어지면 테스트를 작성하기가 어려워진다. DI는 테스트가 작은 단위의 대상에 대해 독립적으로 만들어지고 실행되게 하는 데 중요한 역할을 한다.

참고
토비의 스프링 3.1
