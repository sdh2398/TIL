# TCP 3 Way-Handshake

네트워크 상에서 정보를 주고받으려면 어느 경로, 어떤 방식으로 데이터를 보낼지 등 고려해야할 사항이 많다.
* 만약 하나의 규약을 정해놓았다면 문제가 발생했을 때 전체를 바꿔야 하고, 또 문제가 발생하기 쉬울 것이다.
* 그래서 역할을 나누어 네트워크는 네트워크 계층 구조를 가지게 되었다.
* 각각의 계층은 모듈단위로 독립적이지만 서로 상호 유기적인 관계를 가진다.

TCP는 전송 계층(Transport Layer)에 속해있다.
* TCP/IP 계층은 크게 보면 4개로 나눠져 있고 각각의 계층마다 하는 역할이 다르고 각각의 여러 프로토콜이 존재한다.
* 두 호스트 간에 연결을 맺고 최종적인 통신 목적지까지 데이터를 전달하는 기능을 담당
* 전송 계층에는 크게 TCP, UDP 2가지가 있다.

TCP
* 연결지향적
    * 데이터를 전송하는 측과 받는 측에서 서로 전송 선로(session)을 만든다는 의미
    * 데이터의 신뢰도가 중요하다고 판단될 때 주로 사용
* 오류제어, 흐름제어, 혼잡제어, 타이머재전송 등의 기능을 한다.

UDP
* 비연결지향적
* 최소한의 오류제어 기능만 수행
* 단순히 데이터를 주고 받기만 하는 프로토콜이다.
* 실시간 멀티미디어 정보를 처리하기 위해서 주로 사용

TCP의 연결지향적인 특징을 갖게 해주는 과정이 3 Way-Handshake 방식이다.
* 네트워크 상에서 서로 패킷을 주고받아 해당 과정을 수행한다.

TCP의 3 Way-Handshake 과정
* 클라는 서버에 접속을 요청하는 SYN 패킷을 보낸다.
    * 클라는 SYN/ACK응답을 기다리는 SYN_SENT 상태가 된다.
* 서버는 Listen 상태여야 하고, 서버는 SYN요청을 받고 클라에게 요청을 수락한다는 ACK와 SYN가 설정된 패킷을 발송한 다음에 ACK으로 응답하기를 기다린다.
    * 서버는 SYN_RECEIVED 상태가 된다.
* 클라는 서버에 ACK를 보내고 이후로부터는 데이터가 오가게 된다.
    * 서버의 상태가 ESTABLISHED가 된다.

3 Way-Handshake 과정을 통해 TCP는 연결지향적인 특성과 자체적으로 오류를 처리하며 순서가 뒤바뀐 패킷을 교정해주는 기능이 주로 데이터의 신뢰도가 중요하다고 판단되어질 때 쓰인다.
* 신뢰도 확보가 중요하거나 용량이 큰 데이터를 전달해야 할 때, 실시간일 필요는 없을 때 활용

스트리밍 서비스 같이 데이터의 신뢰성 보다 전송 속도가 중요시되는 서비스 같은 경우, 계속해서 버퍼링이 걸린다면 사용자는 매우 불쾌할 것이다.
* UDP 프로토콜은 연결과정이 없고 단순히 데이터만을 전송하므로 속도가 빠르다.
* 약간의 화질이나 음질의 손상이 있다 해도 끊기지 않는 서비스가 중요하다.

참고
* https://sleepyeyes.tistory.com/4